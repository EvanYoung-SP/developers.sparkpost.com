---
layout: default
class: api-reference
title: "SMTP API - API Reference"
description: "Use the X-MSYS-API header to customize options for messages sent via SMTP."
---
<div id="apipage" class="container-fluid"><div class="row"><div id="menublock"><input type="text" id="searchFld"><nav id="apimenu"><div class="resource-group"><div class="heading"><a href="index.html" class="text-uppercase">Overview</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="index.html#header-api-endpoints">API Endpoints</a></li><li><a href="index.html#header-api-conventions">API Conventions</a></li><li><a href="index.html#header-authentication">Authentication</a></li><li><a href="index.html#header-api-examples">API examples</a></li><li><a href="index.html#header-using-postman">Using Postman</a></li><li><a href="index.html#header-using-curl">Using cURL</a></li><li><a href="index.html#header-smtp-relay-endpoints">SMTP Relay Endpoints</a></li><li><a href="index.html#header-smtp-security">SMTP Security</a></li><li><a href="index.html#header-rate-limiting">Rate Limiting</a></li><li><a href="index.html#header-account-suspension">Account Suspension</a></li><li><a href="index.html#header-errors">Errors</a></li><li><a href="index.html#header-example-error">Example Error</a></li><li><a href="index.html#header-error-table">Error Table</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="labs-introduction.html" class="text-uppercase">Sparkpost Labs</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="labs-introduction.html#header-available-labs-apis">Available Labs APIs</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="substitutions-reference.html" class="text-uppercase">Substitutions Reference</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="substitutions-reference.html#header-key-features">Key Features</a></li><li><a href="substitutions-reference.html#header-substitution-data">Substitution Data</a></li><li><a href="substitutions-reference.html#header-template-start-and-end-markers">Template Start and End Markers</a></li><li><a href="substitutions-reference.html#header-determination-of-expressions-and-statements">Determination of Expressions and Statements</a></li><li><a href="substitutions-reference.html#header-missing-substitution-values">Missing Substitution Values</a></li><li><a href="substitutions-reference.html#header-default-values">Default Values</a></li><li><a href="substitutions-reference.html#header-statements-on-their-own-line">Statements on Their Own Line</a></li><li><a href="substitutions-reference.html#header-escaping-start-and-end-tags">Escaping Start and End Tags</a></li><li><a href="substitutions-reference.html#header-escaping-html-values">Escaping HTML Values</a></li><li><a href="substitutions-reference.html#header-preventing-html-escaping">Preventing HTML Escaping</a></li><li><a href="substitutions-reference.html#header-personalized-links">Personalized Links</a></li><li><a href="substitutions-reference.html#header-disabling-url-encoding">Disabling URL Encoding</a></li><li><a href="substitutions-reference.html#header-link-names">Link Names</a></li><li><a href="substitutions-reference.html#header-unsubscribe-links">Unsubscribe Links</a></li><li><a href="substitutions-reference.html#header-per-link-disabling-of-click-tracking">Per-link Disabling of Click Tracking</a></li><li><a href="substitutions-reference.html#header-custom-link-sub-paths">Custom Link Sub-Paths</a></li><li><a href="substitutions-reference.html#header-link-attributes-in-text-parts">Link Attributes in Text Parts</a></li><li><a href="substitutions-reference.html#header-substitutions-syntax-examples">Substitutions Syntax Examples</a></li><li><a href="substitutions-reference.html#header-basic-substitution">Basic Substitution</a></li><li><a href="substitutions-reference.html#header-referencing-a-nested-object">Referencing a Nested Object</a></li><li><a href="substitutions-reference.html#header-if-then-else-syntax">if then else Syntax</a></li><li><a href="substitutions-reference.html#header-if-not-syntax">if not Syntax</a></li><li><a href="substitutions-reference.html#header-elseif-syntax">elseif Syntax</a></li><li><a href="substitutions-reference.html#header-expressions-in-conditionals-(,-,-,-,-,-)">Expressions in Conditionals (, , , , , )</a></li><li><a href="substitutions-reference.html#header-relational-and-logical-operators">Relational and Logical Operators</a></li><li><a href="substitutions-reference.html#header-array-iteration">Array Iteration</a></li><li><a href="substitutions-reference.html#header-array-indexing">Array Indexing</a></li><li><a href="substitutions-reference.html#header-links-and-substitution-expressions-within-substitution-values">Links and Substitution Expressions Within Substitution Values</a></li><li><a href="substitutions-reference.html#header-macros">Macros</a></li><li><a href="substitutions-reference.html#header-reserved-recipient-substitution-variables">Reserved Recipient Substitution Variables</a></li><li><a href="substitutions-reference.html#header-substitutions-in-email_rfc822-headers">Substitutions in email_rfc822 Headers</a></li><li><a href="substitutions-reference.html#header-encoding-rules">Encoding Rules</a></li></ul></div></div><div class="resource-group"><div class="heading current"><a href="smtp-api.html" class="text-uppercase">SMTP API</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="smtp-api.html#header-using-the-x-msys-api-custom-header">Using The X-MSYS-API Custom Header</a></li><li><a href="smtp-api.html#header-options-attributes">Options Attributes</a></li><li><a href="smtp-api.html#header-open-and-click-tracking">Open And Click Tracking</a></li><li><a href="smtp-api.html#header-the-sandbox-domain">The Sandbox Domain</a></li><li><a href="smtp-api.html#header-sending-messages-with-cc,-bcc,-and-archive-recipients">Sending Messages with cc, bcc, and archive Recipients</a></li><li><a href="smtp-api.html#header-what-is-an-archive-recipient?">What is an archive recipient?</a></li><li><a href="smtp-api.html#header-comments-on-header-length">Comments on Header Length</a></li><li><a href="smtp-api.html#header-non-ascii-characters">Non-ASCII characters</a></li><li><a href="smtp-api.html#header-invalid-json">Invalid JSON</a></li><li><a href="smtp-api.html#header-smtp-mail-from">SMTP MAIL FROM</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="ab-testing.html" class="text-uppercase">A/B Testing&#xA0;</a><code class="alert-info text-uppercase">Labs</code></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="ab-testing.html#header-a-b-test-properties">A/B Test Properties</a></li><li><a href="ab-testing.html#a-b-testing-a-b-tests">A/B Tests</a><ul class="list-unstyled"><li><a href="ab-testing.html#a-b-testing-a-b-tests-post">Create an A/B Test</a></li><li><a href="ab-testing.html#a-b-testing-a-b-tests-get">List A/B Tests</a></li></ul></li><li><a href="ab-testing.html#a-b-testing-a-b-tests-resource-get">Get an A/B Test</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="account.html" class="text-uppercase">Account</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="account.html#header-using-postman">Using Postman</a></li><li><a href="account.html#header-account-properties">Account Properties</a></li><li><a href="account.html#header-subscription-properties">Subscription Properties</a></li><li><a href="account.html#header-options-properties">Options Properties</a></li><li><a href="account.html#header-usage-properties">Usage Properties</a></li><li><a href="account.html#header-daily-monthly-usage-properties">Daily/Monthly Usage Properties</a></li><li><a href="account.html#header-support-properties">Support Properties</a></li><li><a href="account.html#account-retrieve-get">Retrieve account information</a></li><li><a href="account.html#account-update-put">Update account information</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="inbound-domains.html" class="text-uppercase">Inbound Domains</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="inbound-domains.html#header-inbound-domains-attributes">Inbound Domains Attributes</a></li><li><a href="inbound-domains.html#header-using-postman">Using Postman</a></li><li><a href="inbound-domains.html#inbound-domains-create-and-list">Create and List</a><ul class="list-unstyled"><li><a href="inbound-domains.html#inbound-domains-create-and-list-post">Create an Inbound Domain</a></li><li><a href="inbound-domains.html#inbound-domains-create-and-list-get">List all Inbound Domains</a></li></ul></li><li><a href="inbound-domains.html#inbound-domains-retrieve-and-delete">Retrieve and Delete</a><ul class="list-unstyled"><li><a href="inbound-domains.html#inbound-domains-retrieve-and-delete-get">Retrieve an Inbound Domain</a></li><li><a href="inbound-domains.html#inbound-domains-retrieve-and-delete-delete">Delete an Inbound Domain</a></li></ul></li></ul></div></div><div class="resource-group"><div class="heading"><a href="ip-pools.html" class="text-uppercase">IP Pools</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="ip-pools.html#header-using-postman">Using Postman</a></li><li><a href="ip-pools.html#header-ip-pool-properties">IP Pool Properties</a></li><li><a href="ip-pools.html#ip-pools-ip-pools">IP Pools</a><ul class="list-unstyled"><li><a href="ip-pools.html#ip-pools-ip-pools-get">List IP Pools</a></li><li><a href="ip-pools.html#ip-pools-ip-pools-post">Create an IP Pool</a></li></ul></li><li><a href="ip-pools.html#ip-pools-ip-pools-resource">IP Pools Resource</a><ul class="list-unstyled"><li><a href="ip-pools.html#ip-pools-ip-pools-resource-get">Get IP Pool</a></li><li><a href="ip-pools.html#ip-pools-ip-pools-resource-put">Update an IP Pool</a></li><li><a href="ip-pools.html#ip-pools-ip-pools-resource-delete">Delete an IP Pool</a></li></ul></li></ul></div></div><div class="resource-group"><div class="heading"><a href="metrics.html" class="text-uppercase">Metrics</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="metrics.html#header-data-retention">Data retention</a></li><li><a href="metrics.html#header-using-postman">Using Postman</a></li><li><a href="metrics.html#header-metrics-api-deliverability-glossary">Metrics API Deliverability Glossary</a></li><li><a href="metrics.html#metrics-discoverability-links-get">Metrics Discoverability Links</a></li><li><a href="metrics.html#metrics-deliverability-metrics-get">Deliverability Metrics Summary</a></li><li><a href="metrics.html#metrics-deliverability-metrics-by-domain-get">Deliverability Metrics by Domain</a></li><li><a href="metrics.html#metrics-deliverability-metrics-by-binding-get">Deliverability Metrics by Binding</a></li><li><a href="metrics.html#metrics-deliverability-metrics-by-binding-group-get">Deliverability Metrics by Binding Group</a></li><li><a href="metrics.html#metrics-deliverability-metrics-by-sending-ip-get">Deliverability Metrics by Sending IP</a></li><li><a href="metrics.html#metrics-deliverability-metrics-by-ip-pool-get">Deliverability Metrics by IP Pool</a></li><li><a href="metrics.html#metrics-deliverability-metrics-by-sending-domain-get">Deliverability Metrics by Sending Domain</a></li><li><a href="metrics.html#metrics-deliverability-metrics-by-subaccount-get">Deliverability Metrics by Subaccount</a></li><li><a href="metrics.html#metrics-deliverability-metrics-by-campaign-get">Deliverability Metrics by Campaign</a></li><li><a href="metrics.html#metrics-deliverability-metrics-by-template-get">Deliverability Metrics by Template</a></li><li><a href="metrics.html#metrics-deliverability-metrics-by-watched-domain-get">Deliverability Metrics by Watched Domain</a></li><li><a href="metrics.html#metrics-time-series-get">Time-Series Metrics</a></li><li><a href="metrics.html#metrics-bounce-reasons-get">Bounce Reason Metrics</a></li><li><a href="metrics.html#metrics-bounce-reasons-by-domain-get">Bounce Reason Metrics By Domain</a></li><li><a href="metrics.html#metrics-bounce-classifications-get">Bounce Classification Metrics</a></li><li><a href="metrics.html#metrics-rejection-reasons-get">Rejection Reason Metrics</a></li><li><a href="metrics.html#metrics-rejection-reasons-by-domain-get">Rejection Reason Metrics By Domain</a></li><li><a href="metrics.html#metrics-delay-reasons-get">Delay Reason Metrics</a></li><li><a href="metrics.html#metrics-delay-reasons-by-domain-get">Delay Reason Metrics By Domain</a></li><li><a href="metrics.html#metrics-engagement-details-get">Engagement Details</a></li><li><a href="metrics.html#metrics-deliveries-by-attempt-get">Deliveries By Attempt</a></li><li><a href="metrics.html#metrics-binding-groups-list-get">Bindings Groups List</a></li><li><a href="metrics.html#metrics-bindings-list-get">Bindings List</a></li><li><a href="metrics.html#metrics-ip-pools-list-get">IP Pools List</a></li><li><a href="metrics.html#metrics-sending-ips-list-get">Sending IPs List</a></li><li><a href="metrics.html#metrics-campaigns-list-get">Campaigns List</a></li><li><a href="metrics.html#metrics-domains-list-get">Domains List</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="message-events.html" class="text-uppercase">Message Events</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="message-events.html#header-data-retention">Data retention</a></li><li><a href="message-events.html#header-using-postman">Using Postman</a></li><li><a href="message-events.html#header-copyrights">Copyrights</a></li><li><a href="message-events.html#message-events-events-documentation-get">Documentation</a></li><li><a href="message-events.html#message-events-events-samples-get">Samples</a></li><li><a href="message-events.html#message-events-message-events-get">Search for Message Events</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="recipient-lists.html" class="text-uppercase">Recipient Lists</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="recipient-lists.html#header-using-postman">Using Postman</a></li><li><a href="recipient-lists.html#header-recipient-list-attributes">Recipient List Attributes</a></li><li><a href="recipient-lists.html#header-recipient-attributes">Recipient Attributes</a></li><li><a href="recipient-lists.html#header-address-attributes">Address Attributes</a></li><li><a href="recipient-lists.html#header-multichannel-address-attributes">Multichannel Address attributes</a></li><li><a href="recipient-lists.html#header-notes-on-channel">Notes on channel</a></li><li><a href="recipient-lists.html#header-push-specific-attributes">Push Specific Attributes</a></li><li><a href="recipient-lists.html#recipient-lists-create-post">Create a Recipient List</a></li><li><a href="recipient-lists.html#recipient-lists-retrieve-get">Retrieve a Recipient List</a></li><li><a href="recipient-lists.html#recipient-lists-list-get">List all Recipient Lists</a></li><li><a href="recipient-lists.html#recipient-lists-update-put">Update a Recipient List</a></li><li><a href="recipient-lists.html#recipient-lists-delete-delete">Delete a Recipient List</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="relay-webhooks.html" class="text-uppercase">Relay Webhooks</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="relay-webhooks.html#header-using-postman">Using Postman</a></li><li><a href="relay-webhooks.html#header-relay-webhooks-object-properties">Relay Webhooks Object Properties</a></li><li><a href="relay-webhooks.html#header-match-object-properties">Match Object Properties</a></li><li><a href="relay-webhooks.html#header-custom-http-headers-properties">Custom HTTP Headers Properties</a></li><li><a href="relay-webhooks.html#header-field-definitions">Field Definitions</a></li><li><a href="relay-webhooks.html#header-content-attributes">Content Attributes</a></li><li><a href="relay-webhooks.html#header-example-payloads">Example Payloads</a></li><li><a href="relay-webhooks.html#relay-webhooks-create-and-list">Create and List</a><ul class="list-unstyled"><li><a href="relay-webhooks.html#relay-webhooks-create-and-list-post">Create an SMTP Relay Webhook</a></li><li><a href="relay-webhooks.html#relay-webhooks-create-and-list-post-1">Create an SMPP Relay Webhook</a></li><li><a href="relay-webhooks.html#relay-webhooks-create-and-list-get">List all Relay Webhooks</a></li></ul></li><li><a href="relay-webhooks.html#relay-webhooks-retrieve,-update,-and-delete">Retrieve, Update, and Delete</a><ul class="list-unstyled"><li><a href="relay-webhooks.html#relay-webhooks-retrieve,-update,-and-delete-get">Retrieve a Relay Webhook</a></li><li><a href="relay-webhooks.html#relay-webhooks-retrieve,-update,-and-delete-put">Update a Relay Webhook</a></li><li><a href="relay-webhooks.html#relay-webhooks-retrieve,-update,-and-delete-delete">Delete a Relay Webhook</a></li></ul></li></ul></div></div><div class="resource-group"><div class="heading"><a href="sending-domains.html" class="text-uppercase">Sending Domains</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="sending-domains.html#header-using-postman">Using Postman</a></li><li><a href="sending-domains.html#header-sending-domain-attributes">Sending Domain Attributes</a></li><li><a href="sending-domains.html#header-dkim-attributes">DKIM Attributes</a></li><li><a href="sending-domains.html#header-status-attributes">Status Attributes</a></li><li><a href="sending-domains.html#header-verify-attributes">Verify Attributes</a></li><li><a href="sending-domains.html#header-dns-attributes">DNS Attributes</a></li><li><a href="sending-domains.html#sending-domains-create-post">Create a Sending Domain</a></li><li><a href="sending-domains.html#sending-domains-list-get">List all Sending Domains</a></li><li><a href="sending-domains.html#sending-domains-retrieve,-update,-and-delete">Retrieve, Update, and Delete</a><ul class="list-unstyled"><li><a href="sending-domains.html#sending-domains-retrieve,-update,-and-delete-get">Retrieve a Sending Domain</a></li><li><a href="sending-domains.html#sending-domains-retrieve,-update,-and-delete-put">Update a Sending Domain</a></li><li><a href="sending-domains.html#sending-domains-retrieve,-update,-and-delete-delete">Delete a Sending Domain</a></li></ul></li><li><a href="sending-domains.html#sending-domains-verify-post">Verify a Sending Domain</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="sending-ips.html" class="text-uppercase">Sending IPs</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="sending-ips.html#header-using-postman">Using Postman</a></li><li><a href="sending-ips.html#header-sending-ip-properties">Sending IP Properties</a></li><li><a href="sending-ips.html#sending-ips-sending-ips-get">Get all sending IPs</a></li><li><a href="sending-ips.html#sending-ips-sending-ip-resource">Sending IP Resource</a><ul class="list-unstyled"><li><a href="sending-ips.html#sending-ips-sending-ip-resource-get">Get a Sending IP</a></li><li><a href="sending-ips.html#sending-ips-sending-ip-resource-put">Update a Sending IP</a></li></ul></li></ul></div></div><div class="resource-group"><div class="heading"><a href="subaccounts.html" class="text-uppercase">Subaccounts</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="subaccounts.html#header-introduction">Introduction</a></li><li><a href="subaccounts.html#header-terminology">Terminology</a></li><li><a href="subaccounts.html#header-managing-subaccount-data-as-a-service-provider">Managing subaccount data as a Service Provider</a></li><li><a href="subaccounts.html#header-managing-master-account-data-as-a-service-provider">Managing master account data as a Service Provider</a></li><li><a href="subaccounts.html#subaccounts-subaccounts-collection">Subaccounts Collection</a><ul class="list-unstyled"><li><a href="subaccounts.html#subaccounts-subaccounts-collection-get">List subaccounts</a></li><li><a href="subaccounts.html#subaccounts-subaccounts-collection-post">Create a new Subaccount</a></li></ul></li><li><a href="subaccounts.html#subaccounts-subaccounts-summary-get">Retrieve Subaccounts Summary</a></li><li><a href="subaccounts.html#subaccounts-subaccounts-entity">Subaccounts Entity</a><ul class="list-unstyled"><li><a href="subaccounts.html#subaccounts-subaccounts-entity-get">List specific subaccount</a></li><li><a href="subaccounts.html#subaccounts-subaccounts-entity-put">Edit a subaccount</a></li></ul></li></ul></div></div><div class="resource-group"><div class="heading"><a href="suppression-list.html" class="text-uppercase">Suppression List</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="suppression-list.html#header-recipient-database-maintenance">Recipient Database Maintenance</a></li><li><a href="suppression-list.html#header-using-postman">Using Postman</a></li><li><a href="suppression-list.html#header-list-entry-attributes">List Entry Attributes</a></li><li><a href="suppression-list.html#suppression-list-bulk-insert-update-put">Insert or Update List Entries</a></li><li><a href="suppression-list.html#suppression-list-search-get">Search for List Entries</a></li><li><a href="suppression-list.html#suppression-list-retrieve,-delete,-insert-or-update">Retrieve, Delete, Insert or Update</a><ul class="list-unstyled"><li><a href="suppression-list.html#suppression-list-retrieve,-delete,-insert-or-update-get">Retrieve a Recipient Suppression Status</a></li><li><a href="suppression-list.html#suppression-list-retrieve,-delete,-insert-or-update-delete">Delete a List Entry</a></li><li><a href="suppression-list.html#suppression-list-retrieve,-delete,-insert-or-update-put">Insert or Update a List Entry</a></li></ul></li><li><a href="suppression-list.html#suppression-list-list-summary-get">Retrieve Suppression List Summary</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="templates.html" class="text-uppercase">Templates</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="templates.html#header-using-postman">Using Postman</a></li><li><a href="templates.html#header-template-attributes">Template Attributes</a></li><li><a href="templates.html#header-content-attributes">Content Attributes</a></li><li><a href="templates.html#header-header-notes">Header Notes</a></li><li><a href="templates.html#header-email_rfc822-notes">email_rfc822 Notes</a></li><li><a href="templates.html#header-options-attributes">Options Attributes</a></li><li><a href="templates.html#header-error-attributes">Error Attributes</a></li><li><a href="templates.html#templates-create-and-list">Create and List</a><ul class="list-unstyled"><li><a href="templates.html#templates-create-and-list-post">Create a Template</a></li><li><a href="templates.html#templates-create-and-list-get">List all Templates</a></li><li><a href="templates.html#templates-create-and-list-get-1">List Templates selectively</a></li></ul></li><li><a href="templates.html#templates-retrieve-get">Retrieve a Template</a></li><li><a href="templates.html#templates-update-put">Update a Template</a></li><li><a href="templates.html#templates-preview-post">Preview a Template</a></li><li><a href="templates.html#templates-delete-delete">Delete a Template</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="tracking-domains.html" class="text-uppercase">Tracking Domains</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="tracking-domains.html#header-using-postman">Using Postman</a></li><li><a href="tracking-domains.html#header-tracking-domains-attributes">Tracking Domains Attributes</a></li><li><a href="tracking-domains.html#header-port-secure-attributes">Port/Secure Attributes</a></li><li><a href="tracking-domains.html#header-status-attributes">Status Attributes</a></li><li><a href="tracking-domains.html#tracking-domains-create-and-list">Create and List</a><ul class="list-unstyled"><li><a href="tracking-domains.html#tracking-domains-create-and-list-post">Create a Tracking Domain</a></li><li><a href="tracking-domains.html#tracking-domains-create-and-list-get">List all Tracking Domains</a></li></ul></li><li><a href="tracking-domains.html#tracking-domains-retrieve,-update,-and-delete">Retrieve, Update, and Delete</a><ul class="list-unstyled"><li><a href="tracking-domains.html#tracking-domains-retrieve,-update,-and-delete-get">Retrieve a Tracking Domain</a></li><li><a href="tracking-domains.html#tracking-domains-retrieve,-update,-and-delete-put">Update a Tracking Domain</a></li><li><a href="tracking-domains.html#tracking-domains-retrieve,-update,-and-delete-delete">Delete a Tracking Domain</a></li></ul></li><li><a href="tracking-domains.html#tracking-domains-verify-post">Verify a Tracking Domain</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="transmissions.html" class="text-uppercase">Transmissions</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="transmissions.html#header-using-postman">Using Postman</a></li><li><a href="transmissions.html#header-the-sandbox-domain">The Sandbox Domain</a></li><li><a href="transmissions.html#header-transmission-attributes">Transmission Attributes</a></li><li><a href="transmissions.html#header-options-attributes">Options Attributes</a></li><li><a href="transmissions.html#header-inline-content-attributes">Inline Content Attributes</a></li><li><a href="transmissions.html#header-push-attributes">Push Attributes</a></li><li><a href="transmissions.html#header-header-notes">Header Notes</a></li><li><a href="transmissions.html#header-email_rfc822-notes">email_rfc822 Notes</a></li><li><a href="transmissions.html#header-attachment-attributes">Attachment Attributes</a></li><li><a href="transmissions.html#header-inline-image-attributes">Inline Image Attributes</a></li><li><a href="transmissions.html#header-using-a-stored-template">Using a Stored Template</a></li><li><a href="transmissions.html#header-using-a-stored-recipient-list">Using a Stored Recipient List</a></li><li><a href="transmissions.html#header-scheduled-transmissions">Scheduled Transmissions</a></li><li><a href="transmissions.html#transmissions-create-post">Create a Transmission</a></li><li><a href="transmissions.html#transmissions-retrieve-and-delete">Retrieve and Delete</a><ul class="list-unstyled"><li><a href="transmissions.html#transmissions-retrieve-and-delete-get">Retrieve a Scheduled Transmission</a></li><li><a href="transmissions.html#transmissions-retrieve-and-delete-delete">Delete a Transmission</a></li></ul></li><li><a href="transmissions.html#transmissions-&#xA0;delete-transmissions-by-campaign-delete">Delete By Campaign ID</a></li><li><a href="transmissions.html#transmissions-list-get">List All Scheduled Transmissions</a></li></ul></div></div><div class="resource-group"><div class="heading"><a href="webhooks.html" class="text-uppercase">Webhooks</a></div><div class="collapse-content"><ul class="list-unstyled"><li><a href="webhooks.html#header-using-postman">Using Postman</a></li><li><a href="webhooks.html#header-webhooks-object-properties">Webhooks Object Properties</a></li><li><a href="webhooks.html#webhooks-events-documentation-get">Documentation</a></li><li><a href="webhooks.html#webhooks-events-samples-get">Samples</a></li><li><a href="webhooks.html#webhooks-create-post">Create a Webhook</a></li><li><a href="webhooks.html#webhooks-retrieve-get">Retrieve Webhook Details</a></li><li><a href="webhooks.html#webhooks-list-get">List all Webhooks</a></li><li><a href="webhooks.html#webhooks-update-and-delete">Update and Delete</a><ul class="list-unstyled"><li><a href="webhooks.html#webhooks-update-and-delete-put">Update a Webhook</a></li><li><a href="webhooks.html#webhooks-update-and-delete-delete">Delete a Webhook</a></li></ul></li><li><a href="webhooks.html#webhooks-validate-post">Validate a Webhook</a></li><li><a href="webhooks.html#webhooks-batch-status-get">Retrieve Status Information</a></li></ul></div></div></nav></div><div id="contentblock"><header><h1 id="top"></h1></header><section class="resource-group searchable"><h1 id="smtp-api" class="group-heading">SMTP API <a href="#smtp-api" class="permalink"></a></h1><div class="markdown"><p><a name="smtp-api"></a></p>
<p>The SparkPost SMTP API offers an SMTP relay service with extended features available through the <code>X-MSYS-API</code> custom header. See <a href="index.html#header-smtp-relay-endpoints">SMTP Relay Endpoints</a> for the SMTP client configuration needed to use SparkPost as an SMTP relay.</p>
<p>For details on how to get the best out of SMTP delivery through SparkPost, see <a href="https://www.sparkpost.com/docs/tech-resources/smtp-rest-api-performance/">this support article</a>.</p>
<h2 id="header-using-the-x-msys-api-custom-header">Using The X-MSYS-API Custom Header <a class="permalink" href="#header-using-the-x-msys-api-custom-header" aria-hidden="true">¶</a></h2>
<p>You can use the <code>X-MSYS-API</code> header in your SMTP messages to specify a campaign id, metadata, tags, IP pool, CC, BCC, and archive recipient lists and disable open and/or click tracking.</p>
<div class="alert alert-info"><strong>Note</strong>: To use this option you should be familiar with how to encode options as JSON strings, as the value of the header field is a JSON object that specifies the relevant options</div>
<pre><code>X-MSYS-API: {
  <span class="hljs-string">"campaign_id"</span>: <span class="hljs-string">"my_campaign"</span>,
  <span class="hljs-string">"metadata"</span> : {
    <span class="hljs-string">"has_pets"</span>: true,
    <span class="hljs-string">"pet_name"</span>: <span class="hljs-string">"Spot"</span>
  },
  <span class="hljs-string">"cc"</span>: [
    { <span class="hljs-string">"email"</span>: <span class="hljs-string">"cc_recip_1@gmail.com"</span>, <span class="hljs-string">"name"</span>: <span class="hljs-string">"CC 1"</span> },
    { <span class="hljs-string">"email"</span>: <span class="hljs-string">"cc_recip_2@gmail.com"</span>, <span class="hljs-string">"name"</span>: <span class="hljs-string">"CC 2"</span> }
  ],
  <span class="hljs-string">"bcc"</span>: [
    { <span class="hljs-string">"email"</span>: <span class="hljs-string">"bcc_recip_1@gmail.com"</span>, <span class="hljs-string">"name"</span>: <span class="hljs-string">"BCC 1"</span> }
    { <span class="hljs-string">"email"</span>: <span class="hljs-string">"bcc_recip_2@gmail.com"</span>, <span class="hljs-string">"name"</span>: <span class="hljs-string">"BCC 2"</span> }
  ],
  <span class="hljs-string">"archive"</span>: [
    { <span class="hljs-string">"email"</span>: <span class="hljs-string">"archive_recip_1@gmail.com"</span>, <span class="hljs-string">"name"</span>: <span class="hljs-string">"Archive 1"</span> }
    { <span class="hljs-string">"email"</span>: <span class="hljs-string">"archive_recip_2@gmail.com"</span>, <span class="hljs-string">"name"</span>: <span class="hljs-string">"Archive 2"</span> }
  ],
  <span class="hljs-string">"tags"</span>: [
    <span class="hljs-string">"cat"</span>,
    <span class="hljs-string">"dog"</span>
  ],
  <span class="hljs-string">"options"</span> : {
    <span class="hljs-string">"open_tracking"</span>: false,
    <span class="hljs-string">"click_tracking"</span>: false,
    <span class="hljs-string">"transactional"</span>: false,
    <span class="hljs-string">"sandbox"</span>: false,
    <span class="hljs-string">"skip_suppression"</span>: false,
    <span class="hljs-string">"ip_pool"</span>: <span class="hljs-string">"my_ip_pool"</span>,
    <span class="hljs-string">"inline_css"</span>: false
  }
}</code></pre>
<div class="alert alert-info"><strong>Note</strong>: Key-value <a href="substitutions-reference.html">substitutions</a> are not supported in SMTP API. Any substitution_data field provided in the X-MSYS-API header will be ignored.</div>
<p>The fields supported in the X-MSYS-API header are as follows:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>campaign_id</td>
<td>string</td>
<td>Name of the campaign to associate with the SMTP message</td>
<td>no</td>
<td>Maximum length - 64 bytes (same restriction as the REST API)</td>
</tr>
<tr>
<td>metadata</td>
<td>JSON object</td>
<td>JSON key value pairs associated with the SMTP message</td>
<td>no</td>
<td>A maximum of 1000 bytes of metadata is available in click/open events.</td>
</tr>
<tr>
<td>cc</td>
<td>JSON array</td>
<td>Array of recipient addresses that will be included in the “Cc” header</td>
<td>no</td>
<td>A unique message with a unique tracking URL will be generated for each recipient in this list.</td>
</tr>
<tr>
<td>bcc</td>
<td>JSON array</td>
<td>Array of recipient addresses that will be hidden from all other recipients</td>
<td>no</td>
<td>A unique message with a unique tracking URL will be generated for each recipient in this list.</td>
</tr>
<tr>
<td>archive</td>
<td>JSON array</td>
<td>Array of recipient addresses that will be hidden from all other recipients</td>
<td>no</td>
<td>A unique message will be generated for each recipient in this list. The archive copy of the message contains tracking URLs identical to the recipient. For a full description, see <a href="#header-what-is-an-archive-recipient?">What is an archive recipient?</a> section.</td>
</tr>
<tr>
<td>tags</td>
<td>JSON array</td>
<td>Array of text labels associated with the SMTP message</td>
<td>no</td>
<td>Tags are available in click/open events. Maximum number of tags is 10 per recipient, 100 system wide.</td>
</tr>
<tr>
<td>options</td>
<td>JSON object</td>
<td>JSON object in which SMTP API options are defined</td>
<td>no</td>
<td>For a full description, see the <a href="#header-options-attributes">Options Attributes</a>.</td>
</tr>
</tbody>
</table>
<h2 id="header-options-attributes">Options Attributes <a class="permalink" href="#header-options-attributes" aria-hidden="true">¶</a></h2>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Description</th>
<th>Required</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>open_tracking</td>
<td>boolean</td>
<td>Whether open tracking is enabled for this SMTP message</td>
<td>no</td>
<td><a href="#header-open-and-click-tracking">See notes</a> for defaults.</td>
</tr>
<tr>
<td>click_tracking</td>
<td>boolean</td>
<td>Whether click tracking is enabled for this SMTP message</td>
<td>no</td>
<td><a href="#header-open-and-click-tracking">See notes</a> for defaults.</td>
</tr>
<tr>
<td>transactional</td>
<td>boolean</td>
<td>Whether message is <a href="https://www.sparkpost.com/resources/infographics/email-difference-transactional-vs-commercial-emails/">transactional</a>, for unsubscribe and suppression purposes<br><span class="label label-info"><strong>Note</strong></span> no List-Unsubscribe header is included in transactional messages</td>
<td>no</td>
<td>Defaults to false.</td>
</tr>
<tr>
<td>sandbox</td>
<td>boolean</td>
<td>Whether to use the sandbox sending domain</td>
<td>no</td>
<td><span class="label label-primary"><strong>SparkPost</strong></span> The sandbox domain is available for SparkPost customers. Defaults to false.</td>
</tr>
<tr>
<td>skip_suppression</td>
<td>boolean</td>
<td>Whether to ignore customer suppression rules, for this SMTP message only.</td>
<td>no</td>
<td><a href="https://www.sparkpost.com/enterprise-email/"><span class="label label-warning"><strong>Enterprise</strong></span></a> Defaults to false.</td>
</tr>
<tr>
<td>ip_pool</td>
<td>string</td>
<td>The ID of a dedicated IP pool associated with your account.  If this field is not provided, the account’s default dedicated IP pool is used (if there are IPs assigned to it).</td>
<td>no</td>
<td><span class="label label-primary"><strong>SparkPost</strong></span> For more information on dedicated IPs, see the <a href="https://www.sparkpost.com/docs/deliverability/dedicated-ip-pools">Support Center</a>.<br><br><a href="https://www.sparkpost.com/enterprise-email/"><span class="label label-warning"><strong>Enterprise</strong></span></a> accounts, contact your TAM for support details.</td>
</tr>
<tr>
<td>inline_css</td>
<td>boolean</td>
<td>Whether to perform CSS inlining in HTML content<br><span class="label label-info"><strong>Note</strong></span> only rules in <code>head &gt; style</code> elements will be inlined</td>
<td>no</td>
<td>Defaults to false.</td>
</tr>
</tbody>
</table>
<h3 id="header-open-and-click-tracking">Open And Click Tracking <a class="permalink" href="#header-open-and-click-tracking" aria-hidden="true">¶</a></h3>
<div class="alert alert-info"><strong><a href="https://www.sparkpost.com/enterprise-email/">SparkPost Enterprise customers</a>:</strong> SMTP click and open tracking are <strong>enabled</strong> by default. Please check with your TAM if you are unsure of the setting in your own environment.</div>
<div class="alert alert-info"><strong>SparkPost customers:</strong> SMTP click and open tracking are <strong>disabled</strong> by default.</div>
<p>To enable click and open tracking in SMTP messages, add the X-MSYS-API header as follows:</p>
<pre><code>X-MSYS-<span class="hljs-string">API:</span> { <span class="hljs-string">"options"</span> : { <span class="hljs-string">"open_tracking"</span> : <span class="hljs-literal">true</span>, <span class="hljs-string">"click_tracking"</span> : <span class="hljs-literal">true</span> } }</code></pre>
<div class="alert alert-info"><strong>SparkPost customers:</strong> the <tt>open_tracking</tt> and <tt>click_tracking</tt> variables may also be set account-wide in your <a href="https://app.sparkpost.com/account/smtp">SMTP relay account settings</a> (<a href="https://app.eu.sparkpost.com/account/smtp">EU</a>).</div>
<h2 id="header-the-sandbox-domain">The Sandbox Domain <a class="permalink" href="#header-the-sandbox-domain" aria-hidden="true">¶</a></h2>
<div class="alert alert-info"><strong>Note</strong>: The Sandbox Domain is available to SparkPost customers only</div>
<p>The sandbox domain <code>sparkpostbox.com</code> is available to allow each account to send test messages in advance of configuring a real sending domain. Each SparkPost account has a lifetime allowance of 5 sandbox domain messages. That means one may send up to 5 test messages using <code>From: something@sparkpostbox.com</code>. Note that you can set the ‘local part’ (the part before the @) to any valid email local part.</p>
<h2 id="header-sending-messages-with-cc,-bcc,-and-archive-recipients">Sending Messages with cc, bcc, and archive Recipients <a class="permalink" href="#header-sending-messages-with-cc,-bcc,-and-archive-recipients" aria-hidden="true">¶</a></h2>
<p>When submitting an email via SMTP that includes the X-MSYS-API header, you may specify a JSON array for cc, bcc, and archive lists.  For each address in each of these arrays, a message will be generated. Messages will be generated with the following headers:</p>
<ul>
<li>
<p>It is the responsibility of the user to include their own <code>To</code> header in the body of the message.</p>
</li>
<li>
<p>All messages will display the <code>Cc</code> header and the value of that header will include all addresses listed in the <code>cc</code> array.</p>
</li>
<li>
<p>The <code>bcc</code> recipients will each receive a message with the <code>To</code> and <code>Cc</code> headers described above and, additionally, will see a <code>Bcc</code> header with ONLY their own recipient address as the value of the header.</p>
</li>
<li>
<p>The <code>archive</code> recipients will each receive a message with the <code>To</code> and <code>Cc</code> headers described above however, they will not have a <code>Bcc</code> header.</p>
</li>
</ul>
<p>The following are key points about reporting and tracking for cc, bcc, and archive messages:</p>
<ul>
<li>
<p>Each recipient (To, Cc, Bcc, and archive) is counted as a targeted message.</p>
</li>
<li>
<p>A <code>rcpt_type</code> field is available during events through the Webhooks, which designates if the message was a Cc, Bcc, or archive copy.</p>
</li>
<li>
<p>A <code>transmission_id</code> field is available during events through the Webhooks, which can be used to correlate the Cc, Bcc, and archive versions of the messages to one another.</p>
</li>
</ul>
<div class="alert alert-info"><strong>Note</strong>: each recipient will only receive a single instance of each message, even if they appear on more than one of the CC, BCC or archive recipient lists.</div>
<h4 id="header-what-is-an-archive-recipient?">What is an archive recipient? <a class="permalink" href="#header-what-is-an-archive-recipient?" aria-hidden="true">¶</a></h4>
<p>Recipients in the <code>archive</code> list will receive an exact replica of the message that was sent to the RCPT TO address. In particular, any encoded links intended for the <code>RCPT TO</code> recipient will be identical in the archive messages.  In contrast, recipients in the <code>bcc</code> list will have links encoded specific to their address. There will be some small differences between the <code>RCPT TO</code> message and the <code>archive</code> message, for example in headers that contain the delivery address like <code>X-MSFBL</code> and <code>List-Unsubscribe</code>.</p>
<p>For example:</p>
<pre><code>X-MSYS-API: {
   <span class="hljs-string">"cc"</span> : [ <span class="hljs-string">"cc_email1<span class="hljs-variable">@corp</span>.com"</span>, <span class="hljs-string">"cc_email2<span class="hljs-variable">@corp</span>.com"</span> ],
   <span class="hljs-string">"bcc"</span> : [ <span class="hljs-string">"bcc_email1<span class="hljs-variable">@corp</span>.com"</span>, <span class="hljs-string">"bcc_email2<span class="hljs-variable">@corp</span>.com"</span> ],
   <span class="hljs-string">"archive"</span> : [ <span class="hljs-string">"archive_email<span class="hljs-variable">@corp</span>.com"</span> ],
   <span class="hljs-string">"options"</span> : {<span class="hljs-string">"open_tracking"</span> : false, <span class="hljs-string">"click_tracking"</span> : true},
}</code></pre>
<p>You may not specify more than a total of 1000 total recipients in those 3 lists.</p>
<p>You may also specify name and email keys in the <code>cc</code> and <code>bcc</code> JSON arrays in order to produce a friendly <code>Cc</code> or <code>Bcc</code> header. For example:</p>
<pre><code>X-MSYS-API: {
   <span class="hljs-string">"cc"</span> : [
    {
    <span class="hljs-string">"email"</span> : <span class="hljs-string">"cc_recip_1@gmail.com"</span>,
    <span class="hljs-string">"name"</span> : <span class="hljs-string">"CC 1"</span>
    },
    {
    <span class="hljs-string">"email"</span> : <span class="hljs-string">"cc_recip_2@gmail.com"</span>,
    <span class="hljs-string">"name"</span> : <span class="hljs-string">"CC 2"</span>
    }
  ]

  <span class="hljs-string">"bcc"</span> : [
    {
    <span class="hljs-string">"email"</span> : <span class="hljs-string">"bcc_recip_1@gmail.com"</span>,
    <span class="hljs-string">"name"</span> : <span class="hljs-string">"BCC 1"</span>
    }
  ]
}</code></pre>
<h2 id="header-comments-on-header-length">Comments on Header Length <a class="permalink" href="#header-comments-on-header-length" aria-hidden="true">¶</a></h2>
<p>SMTP defines a maximum line length of 1000 characters (including CRLF).  If the value of the <code>X-MSYS-API</code> JSON string is
longer than 998 characters, it will be folded across multiple lines before the message is injected.  An example
of a folded header that will not have issues due to extra spaces:</p>
<pre><code>X-MSYS-<span class="hljs-string">API:</span> {<span class="hljs-string">"options"</span> : {<span class="hljs-string">"open_tracking"</span> : <span class="hljs-literal">false</span>, <span class="hljs-string">"click_tracking"</span> : <span class="hljs-literal">true</span>},
   <span class="hljs-string">"metadata"</span> : {<span class="hljs-string">"has_pets"</span> : <span class="hljs-literal">true</span>, <span class="hljs-string">"pet_name"</span>: <span class="hljs-string">"Spot"</span> }, <span class="hljs-string">"tags"</span> : [<span class="hljs-string">"cat"</span>,
   <span class="hljs-string">"dog"</span>], <span class="hljs-string">"campaign_id"</span> : <span class="hljs-string">"my_campaign"</span>}</code></pre>
<div class="alert alert-warning">When the <tt>X-MSYS-API</tt> header is unfolded on the receiving system, as per <a href="http://www.rfcreader.com/#rfc2822_line324">RFC2822</a>, a single space will be added between each line of the header.</div>
<p>The following example shows how the JSON object in an <code>X-MSYS-API</code> header can be corrupted as a result of folding and unfolding:</p>
<pre><code>X-MSYS-API: {<span class="hljs-string">"options"</span> : {<span class="hljs-string">"open_tracking"</span> : false }, <span class="hljs-string">"campaign_id"</span> : <span class="hljs-string">"my_awes
   ome_campaign"</span> }</code></pre>
<p>Will be unfolded as</p>
<pre><code>X-MSYS-<span class="hljs-string">API:</span> {<span class="hljs-string">"options"</span> : {<span class="hljs-string">"open_tracking"</span> : <span class="hljs-literal">false</span> }, <span class="hljs-string">"campaign_id"</span> : <span class="hljs-string">"my_awes ome_campaign"</span> }</code></pre>
<p>Note the space that was introduced in the <code>my_awes ome_campaign</code> string.</p>
<h2 id="header-non-ascii-characters">Non-ASCII characters <a class="permalink" href="#header-non-ascii-characters" aria-hidden="true">¶</a></h2>
<p>If non-ASCII characters are present in the <code>campaign_id</code>, <code>tags</code>, or <code>metadata</code> fields, they must be escaped using the <code>\u</code> Unicode code point format (<code>\n</code> becomes <code>\u000A</code>), or <a href="http://www.rfcreader.com/#rfc2047">rfc2047</a>-encoded.</p>
<h2 id="header-invalid-json">Invalid JSON <a class="permalink" href="#header-invalid-json" aria-hidden="true">¶</a></h2>
<p>If the <code>X-MSYS-API</code> header contains invalid JSON, the SMTP message will be rejected with one of the following codes:</p>
<table>
<thead>
<tr>
<th>Code</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>550</td>
<td><code>5.6.0 X-MSYS-API 'metadata' must be of type 'json object'</code><br><code>5.6.0 smtpapi_campaign_id context is limited to 64 bytes</code></td>
</tr>
<tr>
<td>421</td>
<td><code>4.3.3 [internal] smtpapi unable to generate unique transmission id</code></td>
</tr>
</tbody>
</table>
<h2 id="header-smtp-mail-from">SMTP MAIL FROM <a class="permalink" href="#header-smtp-mail-from" aria-hidden="true">¶</a></h2>
<p>In many cases the SMTP MAIL FROM (or “envelope from”) address may be any email address.  The address will be overwritten with a SparkPost specific email address before the email is delivered.
If you would like SparkPost to deliver the email with a custom MAIL FROM domain then the domain specified in the MAIL FROM address must be set up ahead of time as a <a href="sending-domains.html#sending-domains-verify-post">CNAME-verified sending domain</a>.</p>
<p><strong>Note:</strong> Sparkpost will <strong>not</strong> overwrite the MAIL FROM address for <a href="https://www.sparkpost.com/enterprise-email/"><span class="label label-warning"><strong>Enterprise</strong></span></a> accounts.</p>
</div></section></div></div></div>